Opening in existing browser session.
ğŸš€ Detailed OneNote Access Test
==================================================
ğŸ” Testing Authentication...
Client ID: 8a52ee61-c61a-4873-bfc6-489fa574e92c
Tenant ID: d8fe6df3-c89e-4fa6-a2f8-cfcc31dffb1c

ğŸŒ Opening browser for authentication...
âœ… Authentication successful!

ğŸ““ Testing Basic OneNote Access (/me/onenote/notebooks)...
âœ… Found 1 personal notebooks:
   1. Emil @ Compose IT Nordic AB
      ID: 1-2013fa0e-59f8-4e1c-b871-8d16ff4aa62d
      Owner: Emil Isacson
      Web URL: https://composeit-my.sharepoint.com/personal/emil_isacson_compose_se/Documents/Emil%20@%20Compose%20IT%20Nordic%20AB


ğŸ‘¥ Testing Shared Notebooks via Groups...
   âš ï¸  Note: Without Group.Read.All permission, we can't enumerate all groups
   â„¹ï¸  Trying alternative approaches...
ğŸ“‹ Found 9 joined teams:
   ğŸ¢ Region Blekinge
      ğŸ“º Found 1 channels
   ğŸ¢ GDPR
      ğŸ“º Found 2 channels
   ğŸ¢ Knowledge
      ğŸ“º Found 4 channels
   ğŸ¢ Compose Internal Development
      ğŸ“º Found 19 channels
   ğŸ¢ SupplierInfoCompose
      ğŸ“º Found 1 channels

ğŸŒ Testing OneNote via SharePoint Sites...
      ğŸ“„ Retrieved page 1 (11 items), finished
ğŸ“‹ Found 11 followed SharePoint sites across 1 pages:
   ğŸŒ Marknad
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Marknad
   ğŸŒ GÃ¤vle
      ğŸ““ Found 2 notebooks:
         - Anteckningsbok fÃ¶r GÃ¤vle
         - GÃ¤vle KB
   ğŸŒ Region Blekinge
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Region Blekinge
   ğŸŒ Intranet
      ğŸ“­ No notebooks in this site
   ğŸŒ GDPR
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r GDPR
   ğŸŒ Ã–rebro
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Ã–rebro
   ğŸŒ SupplierInfoCompose
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r SupplierInfoCompose
   ğŸŒ Knowledge
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Knowledge
   ğŸŒ Compose Internal Development
      ğŸ““ Found 3 notebooks:
         - Anteckningsbok fÃ¶r ComposeInternalDevelopment
         - Compose Collection
         - Predictive insight
   ğŸŒ CustomerTeamCompose
      ğŸ““ Found 4 notebooks:
         - ANNteckningar
         - Anteckningsbok fÃ¶r CustomerTeamCompose
         - MUSE Maintenance Noteringar
         - Notes

ğŸ” Searching for OneNote files via Drive API...
   ğŸ” Searching for: *.one
      âŒ Search failed: 400 - {"error":{"code":"invalidRequest","message":"A potentially dangerous Request.Path value was detected from the client (*).","innerError":{"code":"badArgument","date":"2025-06-13T12:24:34","request-id":"1b0f9b8a-eeb6-43be-9f31-9295d8649cef","client-request-id":"1b0f9b8a-eeb6-43be-9f31-9295d8649cef"}}}
   ğŸ” Searching for: *.onetoc2
      âŒ Search failed: 400 - {"error":{"code":"invalidRequest","message":"A potentially dangerous Request.Path value was detected from the client (*).","innerError":{"code":"badArgument","date":"2025-06-13T12:24:34","request-id":"ae793922-578e-4588-8c7d-86758286f236","client-request-id":"ae793922-578e-4588-8c7d-86758286f236"}}}
   ğŸ” Searching for: name:OneNote
      ğŸ“„ Retrieved page 1 (200 items), continuing...
      ğŸ“„ Retrieved page 2 (2 items), finished
      ğŸ“‹ Found 202 total items across 2 pages, filtering by OneNote MIME types...
      âœ… Found 20 OneNote files (filtered by MIME type)
         ğŸ““ Metadata Onenote.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B8376C997-295C-461C-9D3D-774CB4322BBF%7D&file=Metadata%20Onenote.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Referens.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Referens.one/)
         ğŸ““ BaneNor.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BF0A783C7-E232-43D6-A00B-8357EF02DC13%7D&file=BaneNor.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ node-red.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B71AE5970-8A82-47C2-B45C-ABECD6EFDF4C%7D&file=node-red.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Ellevio test env.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Ellevio test env.one/)
         ğŸ““ Resor.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B56EF6A59-4146-4D2B-BD3B-F1E20B421A89%7D&file=Resor.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Sandvik.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B31704A28-45A2-4B39-9DF5-745988EA214C%7D&file=Sandvik.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Azure project.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BC81B9ABB-2557-4942-8B11-0A316C3A01D6%7D&file=Azure%20project.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Region Blekinge.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B4D767EFF-F430-424E-AD54-C4DE112FF45A%7D&file=Region%20Blekinge.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Fun.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B6E6D6B7F-0223-44B3-BE95-DD718F39C894%7D&file=Fun.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ SL.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B31F03658-12B4-468A-91FE-5DF1E660B597%7D&file=SL.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Personlig.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Personlig One_note/Personlig.one/)
         ğŸ““ Saker ny.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Personlig One_note/Saker ny.one/)
         ğŸ““ KÃ¶r.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BEF2D4D7A-2DA8-4856-B64E-971FFAAE59F8%7D&file=K%C3%B6r.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Powershell.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B7D783163-9E60-4F39-9C45-2A9D7B1C2B76%7D&file=Powershell.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Kone.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B7620D775-1177-4863-AC41-17BFCDF870B5%7D&file=Kone.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ RNLI.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B85CD85FC-1087-42C9-B71C-C7FA1A6F2B32%7D&file=RNLI.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Gammalt.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BF0342F0E-1908-4E7E-BC99-5FE665043D57%7D&file=Gammalt.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Trafikverket.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B6E3FB888-868A-44D5-876B-2D1EE19B5283%7D&file=Trafikverket.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Compose.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Compose.one/)
      â„¹ï¸  Filtered out 182 non-OneNote files
         Example MIME types found: application/json, text/xml, application/octet-stream

â° Checking Recent Files for OneNote...
ğŸ“‹ Checking 10 recent items...
   ğŸ“­ No OneNote items found in recent files

ğŸ” Testing Alternative OneNote Endpoints...

   ğŸ”— Testing: Personal notebooks with sections
      Endpoint: /me/onenote/notebooks?$expand=sections
      âŒ Failed: 403 - {"error":{"code":"10008","message":"One or more of the document libraries on the user or groupâ€™s OneDrive contains more than 5,000 OneNote items (notebooks, sections, section groups) and cannot be queried using the API. Please make sure that none of the user or groupâ€™s document libraries contains more than 5,000 OneNote items. Browse to this page for more information: https://blogs.msdn.microsoft.com/onenotedev/2016/09/11/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library/","innerError":{"date":"2025-06-13T12:24:41","request-id":"6243c9c3-1cdd-4a74-8c08-60281deba97a","client-request-id":"6243c9c3-1cdd-4a74-8c08-60281deba97a"}}}

   ğŸ”— Testing: Business drives (may contain OneNote)
      Endpoint: /me/drives?$filter=driveType eq 'business'
      âœ… Success: Found 2 items
         - PersonalCacheLibrary
         - Dokument

   ğŸ”— Testing: Shared documents (may include OneNote)
      Endpoint: /me/insights/shared
      âœ… Success: Found 10 items
         - Unknown
         - Unknown
         - Unknown

ğŸ” Testing Alternative OneNote Endpoints...

   ğŸ”— Testing: Personal notebooks with sections
      Endpoint: /me/onenote/notebooks?$expand=sections
      âŒ Failed: 403 - {"error":{"code":"10008","message":"One or more of the document libraries on the user or groupâ€™s OneDrive contains more than 5,000 OneNote items (notebooks, sections, section groups) and cannot be queried using the API. Please make sure that none of the user or groupâ€™s document libraries contains more than 5,000 OneNote items. Browse to this page for more information: https://blogs.msdn.microsoft.com/onenotedev/2016/09/11/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library/","innerError":{"date":"2025-06-13T12:24:45","request-id":"52d7e69c-913b-4f45-953f-8de47ac8e493","client-request-id":"52d7e69c-913b-4f45-953f-8de47ac8e493"}}}

   ğŸ”— Testing: Business drives (may contain OneNote)
      Endpoint: /me/drives?$filter=driveType eq 'business'
      âœ… Success: Found 2 items
         - PersonalCacheLibrary
         - Dokument

   ğŸ”— Testing: Shared documents (may include OneNote)
      Endpoint: /me/insights/shared
      âœ… Success: Found 10 items
         - Unknown
         - Unknown
         - Unknown

ğŸ“– Testing Reading Notebook Content...

   ğŸ““ Testing Personal Notebooks...
      ğŸ” Testing: Emil @ Compose IT Nordic AB
         âŒ Failed to get sections: 403 - {"error":{"code":"10008","message":"One or more of the document libraries on the user or groupâ€™s OneDrive contains more than 5,000 OneNote items (notebooks, sections, section groups) and cannot be queried using the API. Please make sure that none of the user or groupâ€™s document libraries contains more than 5,000 OneNote items. Browse to this page for more information: https://blogs.msdn.microsoft.com/onenotedev/2016/09/11/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library/","innerError":{"date":"2025-06-13T12:24:49","request-id":"e877afda-d38a-4bfb-8e08-3fc447ad0ffa","client-request-id":"e877afda-d38a-4bfb-8e08-3fc447ad0ffa"}}}
         âš ï¸  Rate limited due to too many items

   ğŸŒ Testing SharePoint Notebooks (sample)...
      ğŸ” Testing: Anteckningsbok fÃ¶r Marknad (from Marknad)
         âœ… Found 1 sections
         ğŸ“„ Testing section: NamnlÃ¶st avsnitt
            âœ… Found 1 pages
            ğŸ“ Testing page: 
               âŒ Failed to read page content: Expecting value: line 1 column 1 (char 0)
      ğŸ” Testing: Anteckningsbok fÃ¶r GÃ¤vle (from GÃ¤vle)
         âœ… Found 0 sections
         ğŸ“­ No sections in notebook
      ğŸ” Testing: GÃ¤vle KB (from GÃ¤vle)
         âœ… Found 16 sections
         ğŸ“„ Testing section: AngularJS
            âœ… Found 1 pages
            ğŸ“ Testing page: Create Pagination with AngularJS
               âŒ Failed to read page content: Expecting value: line 1 column 1 (char 0)

   ğŸ“Š Content Reading Summary:
      âœ… Successfully read content: 0
      ğŸš« Rate limited/restricted: 1
      âŒ Failed to read: 2
      ğŸ” SharePoint notebooks tested: 3

==================================================
ğŸ“Š SUMMARY:
   Personal notebooks: 1
   Team notebooks: 0
   SharePoint notebooks: 15
   Drive search results: 20
   Recent OneNote files: 0
   Notebooks with readable content: 0
   Restricted/rate-limited notebooks: 1
   Failed content reads: 2
   Total items found: 36

âœ… Found multiple OneNote sources! Consider expanding access.

ğŸ”‘ Current permissions working: User.Read, Notes.Read.All, Notes.ReadWrite.All, Sites.Read.All, Files.Read.All
ğŸš« Missing: Group.Read.All (requires admin consent)
