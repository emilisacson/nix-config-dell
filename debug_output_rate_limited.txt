Opening in existing browser session.
🧪 Testing Rate-Limited OneNote Export
==================================================
🔐 Authenticating with Microsoft Graph...
🌐 Opening browser for authentication...
✅ Authentication successful!

📓 Getting personal notebooks...
📓 Checking personal notebooks...
✅ Found 1 personal notebooks
✅ Found 1 personal notebooks

🎯 Testing rate-limited notebook: Emil @ Compose IT Nordic AB
      ⚠️  Notebook rate-limited (>5000 items), trying alternative access...
      🔧 Trying alternative access methods for rate-limited notebook...
         📄 Method 1: Getting recent pages...
         🔍 Method 2: Using drive search results...
🔍 Searching for individual OneNote files via Drive API...
   📋 Found 200 search results
   ✅ Found 20 OneNote files
         📁 Found 20 OneNote files in drive
      ✅ Successfully accessed via alternative method!
✅ Successfully got notebook structure via alternative methods!
   📚 Notebook: Emil @ Compose IT Nordic AB
   🌐 Site: Personal (Drive Files)
   📁 Sections: 1
   📄 Total pages: 10

📝 Creating export file...
   📓 Creating: test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb
         📁 Processing drive file: Metadata Onenote.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 8376C997-295C-461C-9...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Referens.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 597496bf-841c-49db-b...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: BaneNor.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: F0A783C7-E232-43D6-A...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: node-red.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 71AE5970-8A82-47C2-B...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Ellevio test env.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 597496bf-841c-49db-b...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Resor.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 56EF6A59-4146-4D2B-B...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Sandvik.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 31704A28-45A2-4B39-9...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Azure project.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: C81B9ABB-2557-4942-8...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Region Blekinge.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 4D767EFF-F430-424E-A...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Fun.one
            🔍 Attempting to access drive file content...
            🌐 OneNote file detected, trying OneNote API access...
            📄 Trying OneNote-specific API with sourcedoc: 6E6D6B7F-0223-44B3-B...
            🔄 Trying direct file access...
            📋 Getting file metadata as fallback...
            ❌ Could not get file metadata: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
      ✅ Exported 10 pages to test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb
✅ Export successful: test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb

🎉 Rate-limited export test PASSED!
