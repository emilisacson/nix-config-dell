Opening in existing browser session.
🧪 Testing Rate-Limited OneNote Export
==================================================
🔐 Authenticating with Microsoft Graph...
🌐 Opening browser for authentication...
✅ Authentication successful!

📓 Getting personal notebooks...
📓 Checking personal notebooks...
✅ Found 1 personal notebooks
✅ Found 1 personal notebooks

🎯 Testing rate-limited notebook: Emil @ Compose IT Nordic AB
      ⚠️  Notebook rate-limited (>5000 items), trying alternative access...
      🔧 Trying alternative access methods for rate-limited notebook...
         📄 Method 1: Getting recent pages...
         🔍 Method 2: Using drive search results...
🔍 Searching for individual OneNote files via Drive API...
   📋 Found 200 search results
   ✅ Found 20 OneNote files
         📁 Found 20 OneNote files in drive
      ✅ Successfully accessed via alternative method!
✅ Successfully got notebook structure via alternative methods!
   📚 Notebook: Emil @ Compose IT Nordic AB
   🌐 Site: Personal (Drive Files)
   📁 Sections: 1
   📄 Total pages: 10

📝 Creating export file...
   📓 Creating: test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb
         📁 Processing drive file: Metadata Onenote.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Referens.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: BaneNor.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: node-red.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Ellevio test env.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Resor.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Sandvik.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Azure project.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Region Blekinge.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
         📁 Processing drive file: Fun.one
            🔍 Attempting to access drive file content...
            ❌ Could not get file content: 404 - {"error":{"code":"itemNotFound","message":"The resource could not be found."}}
      ✅ Exported 10 pages to test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb
✅ Export successful: test_rate_limited_export/Personal_(Drive_Files)/Emil_@_Compose_IT_Nordic_AB.ipynb

🎉 Rate-limited export test PASSED!
