Opening in existing browser session.
ğŸš€ Detailed OneNote Access Test
==================================================
ğŸ” Testing Authentication...
Client ID: 8a52ee61-c61a-4873-bfc6-489fa574e92c
Tenant ID: d8fe6df3-c89e-4fa6-a2f8-cfcc31dffb1c

ğŸŒ Opening browser for authentication...
âœ… Authentication successful!

ğŸ““ Testing Basic OneNote Access (/me/onenote/notebooks)...
âœ… Found 1 personal notebooks:
   1. Emil @ Compose IT Nordic AB
      ID: 1-2013fa0e-59f8-4e1c-b871-8d16ff4aa62d
      Owner: Emil Isacson
      Web URL: https://composeit-my.sharepoint.com/personal/emil_isacson_compose_se/Documents/Emil%20@%20Compose%20IT%20Nordic%20AB


ğŸ‘¥ Testing Shared Notebooks via Groups...
   âš ï¸  Note: Without Group.Read.All permission, we can't enumerate all groups
   â„¹ï¸  Trying alternative approaches...
âŒ Could not get joined teams: 403 - {"error":{"code":"Forbidden","message":"Missing scope permissions on the request. API requires one of 'Team.ReadBasic.All, TeamSettings.Read.All, TeamSettings.ReadWrite.All, User.Read.All, Directory.Read.All, User.ReadWrite.All, Directory.ReadWrite.All'. Scopes on the request 'Files.Read.All, Notes.Read.All, Notes.ReadWrite.All, openid, profile, Sites.Read.All, User.Read, email'","innerError":{"date":"2025-06-13T12:03:43","request-id":"dc687253-aa29-439e-9dc7-90b651130e8e","client-request-id":"dc687253-aa29-439e-9dc7-90b651130e8e"}}}

ğŸŒ Testing OneNote via SharePoint Sites...
ğŸ“‹ Found 11 followed SharePoint sites:
   ğŸŒ Marknad
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Marknad
   ğŸŒ GÃ¤vle
      ğŸ““ Found 2 notebooks:
         - Anteckningsbok fÃ¶r GÃ¤vle
         - GÃ¤vle KB
   ğŸŒ Region Blekinge
      ğŸ““ Found 1 notebooks:
         - Anteckningsbok fÃ¶r Region Blekinge

ğŸ” Searching for OneNote files via Drive API...
   ğŸ” Searching for: *.one
      âŒ Search failed: 400 - {"error":{"code":"invalidRequest","message":"A potentially dangerous Request.Path value was detected from the client (*).","innerError":{"code":"badArgument","date":"2025-06-13T12:03:46","request-id":"655f965c-4fb6-4979-9c5b-dd1974b4c6cf","client-request-id":"655f965c-4fb6-4979-9c5b-dd1974b4c6cf"}}}
   ğŸ” Searching for: *.onetoc2
      âŒ Search failed: 400 - {"error":{"code":"invalidRequest","message":"A potentially dangerous Request.Path value was detected from the client (*).","innerError":{"code":"badArgument","date":"2025-06-13T12:03:46","request-id":"a6b08db7-a39e-41ac-8fc0-594bf794d4fb","client-request-id":"a6b08db7-a39e-41ac-8fc0-594bf794d4fb"}}}
   ğŸ” Searching for: name:OneNote
      ğŸ“‹ Found 200 total items, filtering by OneNote MIME types...
      âœ… Found 20 OneNote files (filtered by MIME type)
         ğŸ““ Metadata Onenote.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B8376C997-295C-461C-9D3D-774CB4322BBF%7D&file=Metadata%20Onenote.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Referens.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Referens.one/)
         ğŸ““ BaneNor.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BF0A783C7-E232-43D6-A00B-8357EF02DC13%7D&file=BaneNor.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ node-red.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B71AE5970-8A82-47C2-B45C-ABECD6EFDF4C%7D&file=node-red.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Ellevio test env.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Ellevio test env.one/)
         ğŸ““ Resor.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B56EF6A59-4146-4D2B-BD3B-F1E20B421A89%7D&file=Resor.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Sandvik.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B31704A28-45A2-4B39-9DF5-745988EA214C%7D&file=Sandvik.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Azure project.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BC81B9ABB-2557-4942-8B11-0A316C3A01D6%7D&file=Azure%20project.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Region Blekinge.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B4D767EFF-F430-424E-AD54-C4DE112FF45A%7D&file=Region%20Blekinge.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Fun.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B6E6D6B7F-0223-44B3-BE95-DD718F39C894%7D&file=Fun.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ SL.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B31F03658-12B4-468A-91FE-5DF1E660B597%7D&file=SL.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Personlig.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Personlig One_note/Personlig.one/)
         ğŸ““ Saker ny.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Personlig One_note/Saker ny.one/)
         ğŸ““ KÃ¶r.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BEF2D4D7A-2DA8-4856-B64E-971FFAAE59F8%7D&file=K%C3%B6r.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Powershell.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B7D783163-9E60-4F39-9C45-2A9D7B1C2B76%7D&file=Powershell.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Kone.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B7620D775-1177-4863-AC41-17BFCDF870B5%7D&file=Kone.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ RNLI.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B85CD85FC-1087-42C9-B71C-C7FA1A6F2B32%7D&file=RNLI.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Gammalt.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7BF0342F0E-1908-4E7E-BC99-5FE665043D57%7D&file=Gammalt.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Trafikverket.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?sourcedoc=%7B6E3FB888-868A-44D5-876B-2D1EE19B5283%7D&file=Trafikverket.one&action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1
         ğŸ““ Compose.one
            MIME Type: application/msonenote
            URL: https://composeit-my.sharepoint.com/personal/arvid_carlander_compose_se/_layouts/15/Doc.aspx?action=edit&mobileredirect=true&wdorigin=Sharepoint&DefaultItemOpen=1&sourcedoc={597496bf-841c-49db-bf12-4f0593330efb}&wd=target(/Compose.one/)
      â„¹ï¸  Filtered out 180 non-OneNote files
         Example MIME types found: text/xml, application/json, application/octet-stream

â° Checking Recent Files for OneNote...
ğŸ“‹ Checking 10 recent items...
   ğŸ“­ No OneNote items found in recent files

ğŸ” Testing Alternative OneNote Endpoints...

   ğŸ”— Testing: Personal notebooks with sections
      Endpoint: /me/onenote/notebooks?$expand=sections
      âŒ Failed: 403 - {"error":{"code":"10008","message":"One or more of the document libraries on the user or groupâ€™s OneDrive contains more than 5,000 OneNote items (notebooks, sections, section groups) and cannot be queried using the API. Please make sure that none of the user or groupâ€™s document libraries contains more than 5,000 OneNote items. Browse to this page for more information: https://blogs.msdn.microsoft.com/onenotedev/2016/09/11/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library/","innerError":{"date":"2025-06-13T12:03:52","request-id":"d0bcabb5-78b7-4519-a726-cc847cec40f4","client-request-id":"d0bcabb5-78b7-4519-a726-cc847cec40f4"}}}

   ğŸ”— Testing: Business drives (may contain OneNote)
      Endpoint: /me/drives?$filter=driveType eq 'business'
      âœ… Success: Found 2 items
         - PersonalCacheLibrary
         - Dokument

   ğŸ”— Testing: Shared documents (may include OneNote)
      Endpoint: /me/insights/shared
      âœ… Success: Found 10 items
         - Unknown
         - Unknown
         - Unknown

ğŸ” Testing Alternative OneNote Endpoints...

   ğŸ”— Testing: Personal notebooks with sections
      Endpoint: /me/onenote/notebooks?$expand=sections
      âŒ Failed: 403 - {"error":{"code":"10008","message":"One or more of the document libraries on the user or groupâ€™s OneDrive contains more than 5,000 OneNote items (notebooks, sections, section groups) and cannot be queried using the API. Please make sure that none of the user or groupâ€™s document libraries contains more than 5,000 OneNote items. Browse to this page for more information: https://blogs.msdn.microsoft.com/onenotedev/2016/09/11/onenote-api-calls-fail-with-a-large-number-of-items-in-a-sharepoint-document-library/","innerError":{"date":"2025-06-13T12:03:55","request-id":"cd22a003-2725-4309-aac4-dea5b856f113","client-request-id":"cd22a003-2725-4309-aac4-dea5b856f113"}}}

   ğŸ”— Testing: Business drives (may contain OneNote)
      Endpoint: /me/drives?$filter=driveType eq 'business'
      âœ… Success: Found 2 items
         - PersonalCacheLibrary
         - Dokument

   ğŸ”— Testing: Shared documents (may include OneNote)
      Endpoint: /me/insights/shared
      âœ… Success: Found 10 items
         - Unknown
         - Unknown
         - Unknown

==================================================
ğŸ“Š SUMMARY:
   Personal notebooks: 1
   Team notebooks: 0
   SharePoint notebooks: 4
   Drive search results: 20
   Recent OneNote files: 0
   Total items found: 25

âœ… Found multiple OneNote sources! Consider expanding access.

ğŸ”‘ Current permissions working: User.Read, Notes.Read.All, Notes.ReadWrite.All, Sites.Read.All, Files.Read.All
ğŸš« Missing: Group.Read.All (requires admin consent)
